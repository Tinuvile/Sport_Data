# 🏆 智能体育数据查询系统

## 📖 项目简介

这是一个集成了**语音识别**、**智能查询解析**和**实时数据展示**的现代化体育数据查询平台。用户可以通过语音或文本方式查询 F1、足球、NBA 等体育数据，系统会自动识别查询意图并返回相应结果。

## ✨ 核心功能

### 🎤 智能语音查询

- **中文语音识别**：基于 FunASR 的高精度语音识别
- **自然语言理解**：智能解析查询意图和参数
- **实时语音交互**：点击即录，实时处理反馈

### 🌐 现代化 Web 界面

- **响应式设计**：支持手机、平板、电脑多端访问
- **美观界面**：Bootstrap 5 + 现代化设计
- **实时数据**：WebSocket 实时通信和数据更新

### 📊 丰富的体育数据

- **F1 赛车**：车手/车队积分榜、赛程、比赛结果
- **足球联赛**：五大联赛积分榜、实时比分、今日比赛
- **NBA 篮球**：球队信息、联盟排名、球员数据、赛程

### 🧠 智能缓存系统

- **查询结果缓存**：自动保存语音查询结果
- **动态选项加载**：页面自动添加缓存的查询选项
- **过期管理**：7 天自动清理过期数据

## 🚀 快速开始

### 环境要求

- Python 3.8+
- Windows/macOS/Linux
- 麦克风设备（语音查询）
- 网络连接（获取实时数据）

### 安装和启动

1. **克隆项目**

```bash
git clone https://github.com/Tinuvile/Sport_Data
cd Sports
```

2. **安装依赖**

```bash
pip install -r requirements.txt
```

3. **启动应用**

```bash
python voice_web_app.py
```

4. **访问应用**
- 主页：http://localhost:5000
- F1 数据：http://localhost:5000/f1
- 足球数据：http://localhost:5000/football
- NBA 数据：http://localhost:5000/nba
- 语音查询：http://localhost:5000/voice

## 🎯 使用指南

### 语音查询示例

```
"查询F1车手积分榜"
"湖人队的赛程"
"英超积分榜"
"今天的足球比赛"
"2023年F1车队排名"
"勇士队球员信息"
```

### 支持的查询类型

#### 🏎️ F1 查询

- 车手积分榜：`F1积分榜` / `车手排名`
- 车队积分榜：`F1车队排名` / `车队积分榜`
- 赛程安排：`F1赛程` / `比赛安排`

#### ⚽ 足球查询

- 联赛积分榜：`英超积分榜` / `西甲排名` / `意甲积分榜`
- 今日比赛：`今天的足球比赛`

#### 🏀 NBA 查询

- 球队赛程：`湖人队赛程` / `勇士队比赛`
- 联盟排名：`NBA积分榜` / `联盟排名`
- 球员信息：`湖人队球员` / `球队信息`

## 🏗️ 系统架构

### 核心组件

```
语音输入 → 语音识别 → 查询解析 → 后端API → 数据展示
    ↓           ↓          ↓         ↓        ↓
录音模块    FunASR    QueryParser  各项目API  Web界面
```

### 技术栈

- **后端**：Flask + WebSocket + RESTful API
- **前端**：Bootstrap 5 + Chart.js + Font Awesome
- **语音**：FunASR + sounddevice
- **数据**：FastF1 + NBA_API + Football-data.org

## 📁 项目结构

```
Sports/
├── voice_web_app.py           # 主应用入口
├── voice_query_system.py      # 语音查询系统
├── query_cache.py             # 查询缓存系统
├── requirements.txt           # 统一依赖文件
├── README.md                  # 项目文档
├── .gitignore                # Git忽略文件
├── templates/                # HTML模板
│   ├── base.html            # 基础模板
│   ├── index.html           # 主页
│   ├── f1.html              # F1页面
│   ├── football.html        # 足球页面
│   ├── nba.html             # NBA页面
│   └── voice.html           # 语音查询页面
├── static/                  # 静态资源
├── backend/                 # 后端API模块
│   ├── f1_api.py           # F1数据API
│   ├── football_api.py     # 足球数据API
│   ├── nba_api.py          # NBA数据API
│   └── ...
├── cache/                   # 缓存目录
├── logs/                    # 日志目录
└── recordings/              # 录音文件目录
```

## 🔧 配置说明

### 语音识别配置

- 模型：paraformer-zh（中文识别）
- 采样率：16000Hz
- 声道：单声道

### API 配置

- F1 数据：FastF1 + Ergast API
- 足球数据：Football-data.org API
- NBA 数据：NBA_API + ESPN API

## 🎨 界面特色

### 查询结果可视化

- **智能展示**：根据查询类型自动生成对应的可视化界面
- **NBA 球员信息**：按位置分组展示，包含详细身体数据和经验
- **积分榜展示**：现代化表格设计，颜色标识排名区域
- **比赛信息**：卡片式布局，清晰显示对阵和比分
- **原始数据折叠**：JSON 数据可折叠查看，界面更简洁

### 数据展示优化

- **表格设计**：现代化深色表头、条纹行
- **颜色标识**：根据排名/资格区域显示不同颜色
- **详细数据**：完整统计信息和图标
- **说明图例**：底部显示各区域含义

### 预设选项

- **足球**：10 个主要联赛（英超、西甲、德甲等）
- **NBA**：全部 30 支球队，按东西部分组
- **F1**：2015-2024 年所有赛季

## 🛠️ 开发指南

### 添加新的体育项目

1. 在 `backend/` 创建新的 API 模块
2. 在 `voice_query_system.py` 添加查询解析逻辑
3. 创建对应的 HTML 模板
4. 添加路由和 API 端点

### 自定义语音命令

在 `voice_query_system.py` 的 `QueryParser` 类中添加新的解析规则。

## 🔍 故障排除

### 常见问题

1. **语音识别失败**：检查麦克风权限和设备
2. **数据加载慢**：检查网络连接
3. **端口被占用**：更换端口或关闭占用进程

### 日志查看

```bash
# 查看应用日志
tail -f logs/app.log

# 查看语音系统日志
tail -f logs/voice_system.log
```

## 📄 许可证

本项目采用 MIT 许可证。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

**享受智能体育数据查询的便利！** 🎉
